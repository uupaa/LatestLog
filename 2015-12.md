## 2015-12

### 2015-12-21

先日、 国内キャリア(docomo, au, softbank)から発売済みの Android 4.4.x 端末で予定されていた Android 5.0.x へのアップデート作業が完了しました。

これにより、国内キャリアから発売された端末の 70%以上が Android 5.0.x に切り替わったと考えられます。
(割合ベースでは **46%** ですが、不人気端末はOSアップデートが実施されない事を考慮すると、販売台数ベースでは 70% 以上の端末が Android 4.4.x → 5.0.x に更新されていると考えられます)

| キャリア別 | 4.4.x 端末 | 5.x update 端末 | アップデート率 |
|------------|------------|-----------------|----------------|
| docomo     | 18         | 12              | 66 %           |
| au         | 20         | 9               | 45 %           |
| softbank   | 10         | 1               | 10 %           |
| 合計       | 48         | 22              | **46 %**       |

| メーカー別 | 4.4.x 端末 | 5.x update 端末 | アップデート率 |
|------------|------------|-----------------|----------------|
| SONY       |  9         | 8               | 89 %           |
| SAMSUNG    |  8         | 7               | 88 %           |
| LG         |  3         | 2               | 67 %           |
| FUJITSU    |  4         | 2               | 50 %           |
| SHARP      |  13        | 3               | 23 %           |
| KYOCERA    |  8         | 0               |  0 %           |
| ASUS       |  1         | 0               |  0 %           |
| HTC        |  1         | 0               |  0 %           |
| HUAWEI     |  1         | 0               |  0 %           |

より詳しく知りたい方は、 [Spec.js](https://github.com/uupaa/Spec.js/blob/master/lib/SpecCatalog.js) のデータを直接参照してください。

```
// --- docomo ---
    // 2014 winter
                  SoC          発売日 OS Version
 *  "SO-01G":   [ "MSM8974AC",  1410, "444-502" ], // SONY    Xperia Z3
 *  "SO-02G":   [ "MSM8974AC",  1411, "442-502" ], // SONY    Xperia Z3 Compact
 *  "SC-01G":   [ "APQ8084",    1410, "442-501" ], // SAMSUNG GALAXY Note Edge
 *  "SC-02G":   [ "MSM8974AC",  1410, "442-500" ], // SAMSUNG GALAXY S5 ACTIVE
 *  "SC-03G":   [ "MSM8974AC",  1412, "442-502" ], // SAMSUNG GALAXY Tab S 8.4
 *  "SH-01G":   [ "MSM8974AB",  1411, "442-502" ], // SHARP   AQUOS ZETA SH-01G
    "SH-02G":   [ "MSM8974AB",  1411, "442-442" ], // SHARP   Disney Mobile on docomo SH-02G
 *  "F-02G":    [ "MSM8974AB",  1411, "442-502" ], // FUJITSU ARROWS NX F-02G
    "F-03G":    [ "MSM8974AB",  1411, "442-442" ], // FUJITSU ARROWS Tab F-03G
    // 2014 summer
 *  "SC-04F":   [ "MSM8974AC",  1405, "442-500" ], // SAMSUNG GALAXY S5
 *  "SO-03F":   [ "MSM8974AB",  1405, "442-502" ], // SONY    Xperia Z2
    "SO-04F":   [ "MSM8974AA",  1406, "442-442" ], // SONY    Xperia A2
 *  "SO-05F":   [ "MSM8974AB",  1405, "442-502" ], // SONY    Xperia Z2 Tablet
 *  "SH-04F":   [ "MSM8974AB",  1405, "442-502" ], // SHARP   AQUOS ZETA SH-04F
    "SH-05F":   [ "MSM8974AA",  1405, "422-422" ], // SHARP   Disney Mobile on docomo SH-05F
    "SH-06F":   [ "MSM8974AB",  1406, "442-442" ], // SHARP   AQUOS PAD SH-06F
 *  "F-05F":    [ "MSM8974AB",  1405, "442-502" ], // FUJITSU ARROWS NX F-05F
    "F-06F":    [ "MSM8926",    1407, "442-442" ], // FUJITSU Silver age model F-06F
// --- au ---
    // 2015 winter
    "KYV33":    [ "MSM8974AB",  1502, "444-444" ], // KYOCERA INFOBAR A03
    "SHV31":    [ "MSM8974AB",  1501, "444-444" ], // SHARP   AQUOS SERIE mini
    "KYV32":    [ "MSM8974AB",  1502, "444-444" ], // KYOCERA BASIO
    "KYL23":    [ "MSM8926",    1501, "444-444" ], // KYOCERA miraie (no Google Play)
    "SHF32":    [ "MSM8926",    1507, "444-444" ], // SHARP   AQUOS K
    "SHF31":    [ "MSM8926",    1502, "444-444" ], // SHARP   AQUOS K
    // 2014 fall and winter
 *  "SCT21":    [ "MSM8974AC",  1412, "444-502" ], // SAMSUNG GALAXY Tab S
 *  "LGV31":    [ "MSM8974AC",  1412, "442-502" ], // LG      isai VL
    "KYV31":    [ "MSM8974AB",  1412, "444-444" ], // KYOCERA URBANO V01
 *  "SOL26":    [ "MSM8974AC",  1410, "444-502" ], // SONY    Xperia Z3
 *  "SCL24":    [ "APQ8084",    1410, "444-501" ], // SAMSUNG GALAXY Note Edge
    // 2014 summer
    "AST21":    [ "Z3580",      1408, "442-442" ], // ASUS    MeMO Pad 8
 *  "SOT21":    [ "MSM8974AB",  1407, "442-502" ], // SONY    Xperia Z2 Tablet
    "HTL23":    [ "MSM8974AC",  1408, "442-444" ], // HTC     HTC J butterfly
    "KYY24":    [ "MSM8928",    1407, "442-442" ], // KYOCERA TORQUE G01
    "KYY23":    [ "MSM8974AB",  1406, "442-442" ], // KYOCERA URBANO L03
 *  "SHL25":    [ "MSM8974AB",  1406, "442-502" ], // SHARP   AQUOS PHONE SERIE SHL25
 *  "SCL23":    [ "MSM8974AC",  1405, "442-500" ], // SAMSUNG Galaxy S5
 *  "SOL25":    [ "MSM8974AB",  1405, "442-502" ], // SONY    Xperia ZL2
 *  "LGL24":    [ "MSM8974AC",  1407, "442-502" ], // LG      isai FL
// --- softbank ---
    "404KC":    [ "MSM8916",    1502, "444-444" ], // KYOCERA DIGNO U
    "402LG":    [ "MSM8926",    1502, "442-442" ], // LG      Spray
    "403SC":    [ "MSM8926",    1412, "442-442" ], // SAMSUNG GALAXY Tab 4
    "402SH":    [ "MSM8974AB",  1412, "444-444" ], // SHARP   AQUOS CRYSTAL X
    "403HW":    [ "KIRIN910",   1412, "442-442" ], // HUAWEI  MediaPad M1 8.0
    "401SH":    [ "MSM8926",    1411, "442-442" ], // SHARP   Simple Smart Phone 2
 *  "401SO":    [ "MSM8974AC",  1411, "444-502" ], // SONY    Xperia Z3
    "302KC":    [ "MSM8926",    1409, "442-442" ], // KYOCERA DIGNO T
    "305SH":    [ "MSM8926",    1409, "442-442" ], // SHARP   AQUOS CRYSTAL 305SH
    "304SH":    [ "MSM8974AB",  1405, "442-442" ], // SHARP   AQUOS Xx 304SH

 * は Android 4.4.x から 5.0.x にアップデートされた端末です
```


### 2015-12-12

- 余裕がある状態なら関数をコールバックするメカニズム requestIdleCallback が [Chrome 47 に実装されました](https://www.chromestatus.com/feature/5572795866021888)
    - [requestIdleCallback Spec](https://w3c.github.io/requestidlecallback/)
    - ![](https://gyazo.com/cff6d3bc96e2f6aed6af7ec41f310631.png)
    - window.requestIdleCallback(**callback**:IdleRequestCallbackFunction, **options**:IdleRequestOptionsObject = null):UINT32
    - requestIdleCallback で登録した関数を呼び出さないようにする window.cancelIdleCallback(**handle**:UINT32):void もあります
    - options に `{ timeout: 1000 }` を指定すると、1秒後にタイムアウトします
    - callback は callback(**deadline**:deadlineObject):void の形でコールバックします
    - deadlineObject は { didTimeout: Boolean, timeRemaining: timeRemainingFunction } です
    - timeRemainingFunction は DOMHighResTimeStamp を返す関数です

        ```js
        var count = 0;
        function idle(deadline) {
            console.log( deadline.didTimeout, deadline.timeRemaining() ); // Vsync までの残り時間(ms.us)です
            if (count++ <= 10) {
                requestIdleCallback(idle);
            }
        }
        requestIdleCallback(idle);

        > false 49.92000000000001
        > false 49.96000000000001
        > false 49.955000000000005
        > false 49.985
        > false 49.99000000000001
        > false 49.965
        > false 49.985
        > false 49.99000000000001
        > false 49.970000000000006
        > false 49.99000000000001
        ```

- マウスイベント発生時に同時に押していたキーを取得するメカニズム MouseEvent#getModifierState が [Chrome 47 に実装されました](https://www.chromestatus.com/feature/5662574238498816)
    - [MouseEvent#getModifierState Spec](https://w3c.github.io/uievents/)
    - MouseEvent#getModifierState(modifierkey:String):Boolean
    - [modifierkey](http://www.w3.org/TR/DOM-Level-3-Events-key/#keys-modifier) には "Alt", "Fn", "Meta", "Control", "Shift" などが指定可能です

        ```js
        document.body.onclick = function(event) {
            // Shift key を押しながら画面をクリックすると true になります
            console.log(event.getModifierState("Shift")); // -> true or false
        };
        ```

- DOM Event のタイムスタンプ(timeStamp)の基準となる時刻と値の意味が [Chrome 49 で変更になりました](https://www.chromestatus.com/feature/5523910145605632)
    - Event#timeStamp の値が High Resolution Time Stamp に変更になりました。
    - これまでの Event#timeStamp は Date.now() が返す1970年を基準としたms単位の値でしたが、
      High Resolution Time Stamp はページロードからの秒数(ミリ秒.マイクロ秒)のdouble値になります。
    - 互換性がないため、Event#timeStamp を参照しているコードに心当たりがある場合は気をつけてください

        ```js
        document.body.onclick = function(event) {
            console.log(event.timeStamp); // -> 5426.6900000000005
        };
        ```

- WebAudio OfflineAudio における音楽の一時停止と再開を行うメカニズムが [Chrome 49 に実装されました](https://www.chromestatus.com/feature/5294442458120192)
    - [OfflineAudioContext Spec](https://chromium.googlesource.com/chromium/src/+/cdc0e15efab0e82a6e95deaae11a394535ea82de/third_party/WebKit/Source/modules/webaudio/OfflineAudioContext.idl)
    - OfflineAudioContext#suspend():void
    - OfflineAudioContext#resume():void

- 2013-05 から検討を重ねていた CanvasProxy の検討が中断し、2015-12-01 から [OffscreenCanvas についての検討](https://wiki.whatwg.org/wiki/OffscreenCanvas)が始まっています
    - [CanvasProxy - Support Canvas drawing in workers](https://code.google.com/p/chromium/issues/detail?id=245884)
    - [OffscreenCanvas - Implement and ship the OffscreenCanvas feature](https://code.google.com/p/chromium/issues/detail?id=563816)
    - OffscreenCanvas は WebWorkers上においても完全に非同期で動作することが期待されています
    - この提案は Safari, Chrome, IE, Firefox の座組で吟味が行われており、APIの基本合意に至った場合は広く互換性のある実装が行われる可能性があります
    - 以下は提案されているAPIを使った実装の一例です

        ```js
        // surface.js
        vae surfaceCanvas = document.createElement("canvas");
        surfaceCanvas.width = 300;
        surfaceCanvas.height = 300;
        document.body.appendChild(surfaceCanvas);

        var offscreenCanvas = surfaceCanvas.transferControlToOffscreen();

        //var offscreenCanvas = new OffScreenCanvas(300, 300);
        //var offscreenContext = offscreenCanvas.getContext("webgl");

        var renderWorker = new Worker("renderThread.js");
        renderWorker.postMessage({ message: "init", payload: offscreenCanvas }, [offscreenCanvas]); // transferables

        function tick() {
            requestAnimationFrame(tick);
            renderWorker.postMessage({ message: "update" });
        }
        requestAnimationFrame(tick);
        ```

        ```js
        // renderThread.js
        var gl = null; // WebGL OffscreenCanvas context

        self.onmessage = function(event) {
            switch (event.data.message) {
            case "init":
                var offscreenCanvas = event.data.payload;
                gl = offscreenCanvas.getContext("webgl");
                break;
            case "update":
                update();
            }
        }

        function update() {
            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
            // :
            // :
            gl.commit(); // WebGLRenderingContextBase#commit
        }
        ```

### 2015-12-11

- Softbank 端末の一部に 2016-01-01以降の日付を正しく表示できない機種があります。機種変更が必要です
    - [SHARP社製一部携帯電話をご利用中のお客さまへ大切なご案内](http://www.softbank.jp/mobile/info/personal/news/product/20151009a/)
    - 対象端末

        > 705SH, 810SH, 811SH, 812SH/s/sII, 813SH, 904SH, 905SH, 910SH, 911SH

- Softbank と Y!mobile(旧willcom) の3G帯域再利用に伴い、2017-04-01以降に利用不能になる機種や、通信速度が低速になる機種があります
    - [LTEサービスの拡大および 一部の3Gサービス終了について](http://www.softbank.jp/corp/group/sbm/news/press/2015/20151211_02/?sbpr=info)
    - Softbank 対象機種

        > 101SB, 101SI, 102Z, 102HW, 006Z, 007Z/Z for Biz, 005HW, 101SB, 001SC, 005SH,
        > 007HW, 001P, 002SH, 003P, 004SH/SH PJ, 004Z, 006SH, 007SH/SH J, 007SH KT,
        > 008Z, 009SH, 009SH Y, 009Z, 101F, 101K, 101N, 101P, 101SH, 102P,
        > 102SH/SH II, 103SH, 104SH, 106SH, 107SH/SH B, 204SH, 841SH/SH s,
        > 842SH, 941P, 942P, 943SH, 944SH, 945SH/G, DM010SH, DM011SH, DM012SH, DM013SH,
        > 006Z, 007Z, 005HW, 101SB, C01HW, C02HW, C01LC, C02LC

    - Y!mobile 対象機種

        > WX02S, HX008ZT, HX009ZT, WX02S-H, WX04K, WX04SH, WX05SH, WX06K, 005SH, 007HW, 007Z
        > D01HW, D01NE, D01NX, D01NXII, D02HW, D02NE, D02OP, D03HW, D11LC, D12HW, D12LC, D21HW,
        > D21LC, D21NE, D22HW, D23HW, D24HW, D25HW, D26HW, D31HW, D32HW, D33HW, D41HW, GL03D,
        > H11HW, H11LC, H11T, H12HW, H31IA, S01SH, S01SHⅡ, S11HT, S12HT, S21HT, S22HT, S31HT,
        > S51SE, 302HW, GL07S, GD01, GD03W, GP01, GP02, GP03, GS01, GS02, GS03, S31HW,
        > S41HW, S42HW, 007Z

### 2015-12-09

- Firefox OS がスマートフォン市場から撤退するそうです

    > Mozilla Will Stop Developing And Selling Firefox OS Smartphones
    >
    > via http://techcrunch.com/2015/12/08/mozilla-will-stop-developing-and-selling-firefox-os-smartphones/

- iOS 9.2 がリリースされました

    > [iOS 9.2 released](https://developer.apple.com/library/ios/releasenotes/General/RN-iOSSDK-9.2/index.html#//apple_ref/doc/uid/TP40016638)

- iOS 9.2 Safari に、いくつかの機能が追加されました
    - https://www.macstories.net/news/apple-releases-ios-9-2/

    - `<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">` を追加すると、コンテンツの幅に応じて自動的に縮小しないようにできます
        > https://developer.apple.com/library/ios/releasenotes/General/WhatsNewInSafari/Articles/Safari_9.html#//apple_ref/doc/uid/TP40014305-CH9-SW6

    - Safari でリロードボタンを長押しすると `デスクトップ用のページで開く` が表示されますが、この機能がWebViewでも利用可能になりました
        > Long tapping the Reload button in Safari View Controller now gives options to Reload Without Content Blockers and Request Desktop Site, as it does in Safari.
        > https://developer.apple.com/library/ios/releasenotes/General/RN-iOSSDK-9.2/index.html#//apple_ref/doc/uid/TP40016638

    - Safari で画面の左端で左から右にスワイプすると`戻る`、右端でも同様にすることで `進む` 機能を利用できますが、WebView でこの機能を無効化可能になりました
        > Safari View Controller can now be dismissed using an edge swipe. You must rebuild your app against the iOS 9.2 SDK or later to take advantage of this new behavior.
        > https://developer.apple.com/library/ios/releasenotes/General/RN-iOSSDK-9.2/index.html#//apple_ref/doc/uid/TP40016638

